// generic functions
const random = (min, max) => {
  min = Math.ceil(min)
  max = Math.floor(max)
  return Math.floor(Math.random() * (max - min + 1)) + min
}

const get_random_color = (index) => {
  const hue = index % 2 ? random(0, 180) : random(180, 360)
  const saturation = random(40, 100)
  const luminosity = random(40, 85)
  return `hsl(${hue}, ${saturation}%, ${luminosity}%)`
}

const shuffle = (array) => {
  let j, x, index

  for (index = array.length - 1; index > 0; index--) {
    j = Math.floor(Math.random() * (index + 1))
    x = array[index]
    array[index] = array[j]
    array[j] = x
  }

  return array
}

// create svg shapes
const w3_url = 'http://www.w3.org/2000/svg'
const paths_scales = [1, 0.7, 0.3]
const columns = 6
const rows = 6

// init shapes colors
let shapes_colors = [
  get_random_color(1),
  get_random_color(2),
  get_random_color(3),
]

const shapes_paths = [
  'M895.64 375.46h-31.59a44.14 44.14 0 0 1-44.14-44.14v-57.77a125.06 125.06 0 0 0-125.06-125.06h-26.17a44.14 44.14 0 0 1-44.14-44.13A104.35 104.35 0 0 0 520.19 0h-40.38a104.35 104.35 0 0 0-104.35 104.36 44.14 44.14 0 0 1-44.14 44.13h-26.17a125.06 125.06 0 0 0-125.06 125.06v57.77A44.14 44.14 0 0 1 136 375.46h-31.64A104.35 104.35 0 0 0 0 479.81v40.38a104.35 104.35 0 0 0 104.36 104.35H136a44.14 44.14 0 0 1 44.14 44.14v57.77a125.06 125.06 0 0 0 125.01 125.06h26.17a44.14 44.14 0 0 1 44.14 44.13A104.35 104.35 0 0 0 479.81 1000h40.38a104.35 104.35 0 0 0 104.35-104.36 44.14 44.14 0 0 1 44.14-44.13h26.17a125.06 125.06 0 0 0 125.06-125.06v-57.77a44.14 44.14 0 0 1 44.14-44.14h31.59A104.35 104.35 0 0 0 1000 520.19v-40.38a104.35 104.35 0 0 0-104.36-104.35Z',
  'm564.92 57.17 23.6 185.33a65.45 65.45 0 0 0 90.22 52.09L851 222.37c70.87-29.71 126.08 65.91 64.92 112.44l-148.7 113.1a65.45 65.45 0 0 0 0 104.18L916 665.19c61.16 46.53 5.95 142.15-64.92 112.44l-172.3-72.22a65.45 65.45 0 0 0-90.22 52.09l-23.6 185.33c-9.71 76.23-120.13 76.23-129.84 0L411.48 757.5a65.45 65.45 0 0 0-90.22-52.09L149 777.63c-70.91 29.71-126.12-65.91-65-112.44l148.7-113.1a65.45 65.45 0 0 0 0-104.18L84 334.81c-61.16-46.53-6-142.15 64.92-112.44l172.3 72.22a65.45 65.45 0 0 0 90.22-52.09l23.6-185.33c9.75-76.23 120.17-76.23 129.88 0Z',
  'm916.32 705.1 76 172.81c31.91 72.5-42 146.36-114.45 114.45l-172.81-76a509.12 509.12 0 0 0-410.2 0l-172.81 76c-72.5 31.91-146.36-42-114.45-114.45l76-172.81a509.12 509.12 0 0 0 0-410.2l-76-172.81c-31.91-72.5 42-146.36 114.45-114.45l172.81 76a509.12 509.12 0 0 0 410.2 0l172.81-76c72.5-31.91 146.36 42 114.45 114.45l-76 172.81a509.12 509.12 0 0 0 0 410.2Z',
  'M763.2 263.19a26.38 26.38 0 0 1-26.39-26.38C736.81 106.56 630.24 0 500 0S263.19 106.56 263.19 236.8a26.38 26.38 0 0 1-26.39 26.38C106.56 263.19 0 369.76 0 500s106.56 236.81 236.8 236.81a26.38 26.38 0 0 1 26.39 26.38C263.19 893.44 369.76 1000 500 1000s236.81-106.56 236.81-236.81a26.38 26.38 0 0 1 26.39-26.38c130.24 0 236.8-106.57 236.8-236.81S893.44 263.19 763.2 263.19Z',
  'M1000 294.29C997.47 133.67 866.34 2.54 705.73 0a297.77 297.77 0 0 0-173.28 52 57.41 57.41 0 0 1-64.9 0A297.78 297.78 0 0 0 294.32 0C133.7 2.51 2.55 133.63 0 294.25a297.69 297.69 0 0 0 52 173.3 57.45 57.45 0 0 1 0 64.9 297.69 297.69 0 0 0-52 173.3C2.55 866.37 133.7 997.49 294.32 1000a297.78 297.78 0 0 0 173.23-52 57.41 57.41 0 0 1 64.9 0 297.77 297.77 0 0 0 173.28 52c160.61-2.5 291.74-133.63 294.23-294.25A297.8 297.8 0 0 0 948 532.45a57.45 57.45 0 0 1 0-64.9 297.8 297.8 0 0 0 52-173.26Z',
  'M913.6 688 771.22 561.08q-22.22-19.81-42.39-41.49a28.76 28.76 0 0 1 0-39.18q20.16-21.65 42.39-41.49L913.6 312.05c25.62-22.83 1.62-64.4-31-53.63l-181.03 59.86a639 639 0 0 1-67 18.18 28.87 28.87 0 0 1-32.84-17.58 642.14 642.14 0 0 1-32.1-106.94L531 25.2c-7-33.6-55-33.6-61.92 0l-38.73 186.74a642.14 642.14 0 0 1-32.1 106.94 28.88 28.88 0 0 1-32.85 17.58 639.44 639.44 0 0 1-67-18.18l-181.04-59.86c-32.58-10.77-56.58 30.8-31 53.63l142.41 126.87q22.23 19.81 42.4 41.49a28.76 28.76 0 0 1 0 39.18q-20.16 21.64-42.4 41.49L86.4 688c-25.62 22.83-1.62 64.4 31 53.63l181.07-59.86a639.44 639.44 0 0 1 67-18.18 28.88 28.88 0 0 1 32.85 17.58 642.14 642.14 0 0 1 32.1 106.94L469 974.8c7 33.6 55 33.6 61.92 0l38.69-186.74a642.14 642.14 0 0 1 32.1-106.94 28.87 28.87 0 0 1 32.84-17.58 639 639 0 0 1 67 18.18l181.07 59.86c32.6 10.77 56.6-30.8 30.98-53.58Z',
  'm40 397.82 77.49-82.32a147 147 0 0 0 33.4-57.33l33.41-108a147 147 0 0 1 174.2-99.65l110 25.95a147.19 147.19 0 0 0 66.35.27l110.26-25.09a147 147 0 0 1 173.39 101L851.05 261a146.92 146.92 0 0 0 33 57.59l76.83 82.94a147 147 0 0 1-.8 200.69l-77.54 82.28a147 147 0 0 0-33.4 57.33l-33.41 108a147 147 0 0 1-174.2 99.65l-110-26a147.19 147.19 0 0 0-66.35-.27l-110.29 25.14a147 147 0 0 1-173.39-101L149 739a146.92 146.92 0 0 0-33-57.55l-76.83-82.94A147 147 0 0 1 40 397.82Z',
  'M489.56 17.32c5.77-23.15 14.92-23.08 20.33.16l36.63 157.32c20.1 82 133 142.17 214 118.59l152.31-43.79c22.93-6.59 27.65 1.57 10.48 18.15L806.84 380.16c-60.94 58.4-60.94 181.69 0 240.08l116.43 112.07c17.19 16.55 12.54 24.55-10.34 17.78l-155.26-46c-81-23.58-191 39.51-211.15 121.48l-36.61 156.98c-5.43 23.23-14.46 23.27-20.08.08l-38.76-159.92c-20.1-82-108.93-146.6-190-123L87.23 750.28C64.31 757 59.51 748.74 76.56 732l117.08-114.65c60.94-58.4 60.94-181.69 0-240.08L77.13 267.38c-17.36-16.37-12.78-24.45 10.19-18l155.49 44C323.85 317 431 253.88 451.07 171.91Z',
  'M894.37 409.86c-3.47 0-6.88.15-10.26.43l-294.4-294.4c.28-3.38.43-6.79.43-10.26C590.14 47.29 500 0 500 0s-90.14 47.29-90.14 105.63c0 3.47.15 6.88.43 10.26l-294.4 294.4c-3.38-.28-6.79-.43-10.26-.43C47.29 409.86 0 500 0 500s47.29 90.14 105.63 90.14c3.47 0 6.88-.15 10.26-.43l294.4 294.4c-.28 3.38-.43 6.79-.43 10.26C409.86 952.71 500 1000 500 1000s90.14-47.29 90.14-105.63c0-3.47-.15-6.88-.43-10.26l294.4-294.4c3.38.28 6.79.43 10.26.43C952.71 590.14 1000 500 1000 500s-47.29-90.14-105.63-90.14Z',
  'm258.91 955.73 167.66-167.66a103.85 103.85 0 0 1 146.86 0l167.66 167.66c59 59 155.61 59 214.64 0 59-59 59-155.62 0-214.64L788.07 573.43a103.85 103.85 0 0 1 0-146.86l167.66-167.66c59-59 59-155.61 0-214.64-59-59-155.62-59-214.64 0L573.43 211.93a103.85 103.85 0 0 1-146.86 0L258.91 44.27c-59-59-155.61-59-214.64 0-59 59-59 155.62 0 214.64l167.66 167.66a103.85 103.85 0 0 1 0 146.86L44.27 741.09c-59 59-59 155.61 0 214.64 59.03 59.03 155.62 59.03 214.64 0Z',
  'M932.83 608.81 824.5 500.48l108-108c89.1-89.11 88.89-235.13-.49-324.5-89.37-89.38-235.39-89.59-324.5-.49l-108 108L391.19 67.17c-89.37-89.37-235.4-89.59-324.5-.48-89.11 89.1-88.89 235.13.48 324.5L175.5 499.52l-108 108C-21.61 696.63-21.4 842.65 68 932c89.37 89.38 235.39 89.59 324.5.49l108-108 108.31 108.34c89.37 89.37 235.4 89.59 324.5.48 89.11-89.1 88.89-235.13-.48-324.5Z',
  'M617.75 882.25V698.31a80.56 80.56 0 0 1 80.56-80.56h183.94C947 617.75 1000 564.76 1000 500c0-64.76-53-117.75-117.75-117.75H698.31a80.56 80.56 0 0 1-80.56-80.56V117.75C617.75 53 564.76 0 500 0c-64.76 0-117.75 53-117.75 117.75v183.94a80.56 80.56 0 0 1-80.56 80.56H117.75C53 382.25 0 435.24 0 500c0 64.76 53 117.75 117.75 117.75h183.94a80.56 80.56 0 0 1 80.56 80.56v183.94C382.25 947 435.24 1000 500 1000c64.76 0 117.75-53 117.75-117.75Z',
  'm896.32 396.58 43-43c80.88-80.88 80.88-212 0-292.89-80.88-80.88-212-80.88-292.89 0l-43 43a146.25 146.25 0 0 1-206.84 0l-43-43c-80.88-80.88-212-80.88-292.89 0-80.88 80.88-80.88 212 0 292.89l43 43a146.25 146.25 0 0 1 0 206.84l-43 43c-80.88 80.88-80.88 212 0 292.89 80.88 80.88 212 80.88 292.89 0l43-43a146.25 146.25 0 0 1 206.84 0l43 43c80.88 80.88 212 80.88 292.89 0 80.88-80.88 80.88-212 0-292.89l-43-43a146.25 146.25 0 0 1 0-206.84Z',
  'M646.07 155.76 986.27 6c7.55-3.32 11 .14 7.69 7.69L844.24 353.93a362.63 362.63 0 0 0 0 292.14L994 986.27c3.32 7.55-.14 11-7.69 7.69L646.07 844.24a362.63 362.63 0 0 0-292.14 0L13.73 994c-7.55 3.32-11-.14-7.69-7.69l149.72-340.2a362.63 362.63 0 0 0 0-292.14L6 13.73c-3.32-7.55.14-11 7.69-7.69l340.2 149.72a362.63 362.63 0 0 0 292.18 0Z',
  'M608.23 44.43a168.38 168.38 0 0 0 108.22 39.39A168.36 168.36 0 0 1 882.26 223a168.37 168.37 0 0 0 57.59 99.74 168.36 168.36 0 0 1 37.58 213.16 168.42 168.42 0 0 0-20 113.43 168.37 168.37 0 0 1-108.22 187.4 168.4 168.4 0 0 0-88.23 74 168.37 168.37 0 0 1-203.39 74 168.38 168.38 0 0 0-115.18 0 168.37 168.37 0 0 1-203.39-74 168.4 168.4 0 0 0-88.23-74A168.37 168.37 0 0 1 42.57 649.28a168.42 168.42 0 0 0-20-113.43 168.36 168.36 0 0 1 37.58-213.16A168.37 168.37 0 0 0 117.74 223 168.36 168.36 0 0 1 283.55 83.82a168.38 168.38 0 0 0 108.22-39.39 168.38 168.38 0 0 1 216.46 0Z',
  'm167.14 0 152.48 40.72a699.14 699.14 0 0 0 360.76 0L832.86 0C924.79 0 1000 75.21 1000 167.14l-40.72 152.48a699.14 699.14 0 0 0 0 360.76L1000 832.86c0 91.93-75.21 167.14-167.14 167.14l-152.48-40.72a699.14 699.14 0 0 0-360.76 0L167.14 1000C75.21 1000 0 924.79 0 832.86l40.72-152.48a699.14 699.14 0 0 0 0-360.76L0 167.14C0 75.21 75.21 0 167.14 0Z',
  'm827.55 388.67 131.18 51c55 21.4 55 99.26 0 120.66l-131.18 51a379.57 379.57 0 0 0-216.22 216.22l-51 131.18c-21.4 55-99.26 55-120.66 0l-51-131.18a379.57 379.57 0 0 0-216.22-216.22l-131.18-51c-55-21.4-55-99.26 0-120.66l131.18-51a379.57 379.57 0 0 0 216.22-216.22l51-131.18c21.4-55 99.26-55 120.66 0l51 131.18a379.57 379.57 0 0 0 216.22 216.22Z',
  'M844.36 155.64A155.64 155.64 0 0 0 688.72 0H311.28a155.64 155.64 0 0 0-155.64 155.64A155.64 155.64 0 0 0 0 311.28v377.44a155.64 155.64 0 0 0 155.64 155.64A155.64 155.64 0 0 0 311.28 1000h377.44a155.64 155.64 0 0 0 155.64-155.64A155.64 155.64 0 0 0 1000 688.72V311.28a155.64 155.64 0 0 0-155.64-155.64Z',
  'm512.78 11.3 26.47 215.26c7.46 60.63 78.21 89.93 126.34 52.33L836.52 145.4c12-9.34 27.42 6.11 18.08 18.08L721.11 334.41c-37.6 48.13-8.3 118.88 52.33 126.34l215.26 26.47c15.07 1.85 15.07 23.71 0 25.56l-215.26 26.47c-60.63 7.46-89.93 78.21-52.33 126.34L854.6 836.52c9.34 12-6.11 27.42-18.08 18.08L665.59 721.11c-48.13-37.6-118.88-8.3-126.34 52.33L512.78 988.7c-1.85 15.07-23.71 15.07-25.56 0l-26.47-215.26c-7.46-60.63-78.21-89.93-126.34-52.33L163.48 854.6c-12 9.34-27.42-6.11-18.08-18.08l133.49-170.93c37.6-48.13 8.3-118.88-52.33-126.34L11.3 512.78c-15.07-1.85-15.07-23.71 0-25.56l215.26-26.47c60.63-7.46 89.93-78.21 52.33-126.34L145.4 163.48c-9.34-12 6.11-27.42 18.08-18.08l170.93 133.49c48.13 37.6 118.88 8.3 126.34-52.33L487.22 11.3c1.85-15.07 23.71-15.07 25.56 0Z',
  'M894.37 409.86c-3.47 0-6.88.15-10.26.43-33.91-145.76-148.64-260.49-294.4-294.4.28-3.38.43-6.79.43-10.26C590.14 47.29 500 0 500 0s-90.14 47.29-90.14 105.63c0 3.47.15 6.88.43 10.26-145.76 33.91-260.49 148.64-294.4 294.4-3.38-.28-6.79-.43-10.26-.43C47.29 409.86 0 500 0 500s47.29 90.14 105.63 90.14c3.47 0 6.88-.15 10.26-.43 33.91 145.76 148.64 260.49 294.4 294.4-.28 3.38-.43 6.79-.43 10.26C409.86 952.71 500 1000 500 1000s90.14-47.29 90.14-105.63c0-3.47-.15-6.88-.43-10.26 145.76-33.91 260.49-148.64 294.4-294.4 3.38.28 6.79.43 10.26.43C952.71 590.14 1000 500 1000 500s-47.29-90.14-105.63-90.14Z',
  'M985.75 43.33 840.93 205.59c-72.29 81-113.13 185.61-113.19 294.19v5.68c1.26 106.75 42 209.26 113.12 288.92l144.89 162.29c12.37 19-10 41.45-29.08 29.08L794.41 840.93c-81-72.29-185.61-113.13-294.19-113.19h-5.68c-106.75 1.26-209.26 42-288.92 113.12L43.33 985.75c-19 12.37-41.45-10-29.08-29.08L159.1 794.38c71.09-79.66 111.9-182.17 113.12-288.92v-5.68c-.06-108.58-40.9-213.18-113.19-294.19L14.25 43.33c-12.37-19 10-41.45 29.08-29.08L205.62 159.1c79.66 71.09 182.17 111.9 288.92 113.12h5.68c108.58-.06 213.18-40.9 294.19-113.19L956.67 14.25c19.04-12.37 41.45 10.04 29.08 29.08Z',
  'M997 500c0-27.5-33.2-53-89.79-73.94a120.9 120.9 0 0 1-67.86-163.84c25.2-54.83 30.65-96.33 11.2-115.77s-60.94-14-115.78 11.2a120.9 120.9 0 0 1-163.84-67.86C550 33.2 524.49 0 497 0s-53 33.2-74 89.79a120.9 120.9 0 0 1-163.83 67.86c-54.83-25.2-96.33-30.65-115.78-11.2s-14 60.94 11.21 115.77a120.91 120.91 0 0 1-67.82 163.84C30.18 447-3 472.5-3 500s33.19 53 89.79 73.94a120.91 120.91 0 0 1 67.86 163.84c-25.2 54.83-30.65 96.33-11.21 115.77s60.95 14 115.78-11.2A120.9 120.9 0 0 1 423 910.21c21 56.59 46.49 89.79 74 89.79s53-33.2 73.94-89.79a120.9 120.9 0 0 1 163.83-67.86c54.84 25.2 96.34 30.65 115.78 11.2s14-60.94-11.2-115.77a120.9 120.9 0 0 1 67.85-163.84C963.79 553 997 527.5 997 500Z',
  'M957.82 570.29 647.7 508.87c-9.71-1.93-9.71-15.81 0-17.74l310.12-61.42c43.48-14.49 56.5-69.67 24.1-102.08L672.37 18.08C640-14.32 584.78-1.3 570.29 42.18L508.87 352.3c-1.93 9.71-15.81 9.71-17.74 0L429.71 42.18C415.22-1.3 360-14.32 327.63 18.08L18.08 327.63C-14.32 360-1.3 415.22 42.18 429.71l310.12 61.42c9.71 1.93 9.71 15.81 0 17.74L42.18 570.29C-1.3 584.78-14.32 640 18.08 672.37l309.55 309.55c32.41 32.4 87.59 19.38 102.08-24.1l61.42-310.12c1.93-9.71 15.81-9.71 17.74 0l61.42 310.12c14.49 43.48 69.67 56.5 102.08 24.1l309.55-309.55c32.4-32.37 19.38-87.59-24.1-102.08Z',
  'M0,500a500,500 0 1,0 1000,0a500,500 0 1,0 -1000,0',
]

const create_shape = (colors) => {
  const shuffled_colors = shuffle(colors)

  // create wrapping svg
  const svg = document.createElementNS(w3_url, 'svg')
  svg.setAttribute('viewBox', '0 0 1000 1000')

  // create 5 shapes as paths
  paths_scales.map((scale, index) => {
    // create the path & set its attributes
    const path = document.createElementNS(w3_url, 'path')
    path.setAttribute('transform-origin', 'center')
    path.setAttribute('transform', `scale(${scale})`)
    path.setAttribute('d', shapes_paths[random(0, shapes_paths.length - 1)])
    path.setAttribute('fill', shuffled_colors[index])

    // append the path to the wrapping svg
    svg.append(path)
  })

  // append the wrapping svg to the body
  document.body.append(svg)
}

// execute on window load
window.onload = () => {
  // set background color
  const background_color = get_random_color(0)
  document.body.style.background = background_color

  // create shapes
  for (let i = 0; i < columns * rows; i++) {
    create_shape(shapes_colors)
  }

  // query buttons & add event listeners
  const btn_shapes = document.querySelector('#btn_shapes')
  const btn_color = document.querySelector('#btn_color')

  btn_shapes.addEventListener('click', () => {
    // erase existing shapes
    const svgs = [...document.querySelectorAll('svg')]
    svgs.forEach((svg) => svg.remove())

    // recreate new shapes
    for (let i = 0; i < columns * rows; i++) create_shape(shapes_colors)
  })

  btn_color.addEventListener('click', () => {
    document.body.style.background = get_random_color(0)

    // set the new colors & apply them to shapes
    shapes_colors = [
      get_random_color(1),
      get_random_color(2),
      get_random_color(3),
    ]

    const svgs = [...document.querySelectorAll('svg')]
    svgs.forEach((svg) => {
      const shuffled_colors = shuffle(shapes_colors)
      const paths = [...svg.children]
      paths.forEach((path, index) => {
        path.setAttribute('fill', shuffled_colors[index])
      })
    })
  })
}
